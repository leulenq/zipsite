<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title><%= title ? `${title} — ZipSite` : 'ZipSite' %></title>
  <link rel="stylesheet" href="/styles/global.css">
  <% if (isDashboard) { %>
    <link rel="stylesheet" href="/styles/dashboard.css">
  <% } %>
</head>
<body class="app-shell <%= isDashboard ? 'is-dashboard' : 'is-public' %>">
  <a class="skip-link" href="#main">Skip to content</a>
  <% if (isDashboard) { %>
    <header class="shell-header dashboard-header" role="banner">
      <div class="dashboard-header__inner">
        <a class="brand" href="/">ZipSite</a>
        <nav class="dashboard-nav" aria-label="Account navigation">
          <ul>
            <% if (currentUser?.role === 'TALENT') { %>
              <li><a href="/dashboard/talent" <%= title === 'Talent Dashboard' ? 'aria-current="page"' : '' %>>Talent</a></li>
            <% } %>
            <% if (currentUser?.role === 'AGENCY') { %>
              <li><a href="/dashboard/agency" <%= title === 'Agency Dashboard' ? 'aria-current="page"' : '' %>>Agency</a></li>
            <% } %>
            <% if (currentProfile?.slug) { %>
              <li><a href="/portfolio/<%= currentProfile.slug %>" target="_blank" rel="noopener">Public Portfolio</a></li>
            <% } %>
          </ul>
        </nav>
        <div class="dashboard-header__meta">
          <% if (currentUser) { %>
            <span class="dashboard-header__user"><%= currentUser.email %></span>
            <form action="/logout" method="post">
              <button type="submit" class="button button-secondary">Logout</button>
            </form>
          <% } %>
        </div>
      </div>
    </header>
  <% } else { %>
    <header class="site-header" role="banner">
      <div class="container site-header__inner">
        <a class="brand" href="/">ZipSite</a>
        <button class="mobile-nav-toggle" aria-expanded="false" aria-controls="mobileNav">Menu</button>
        <nav class="primary-nav" aria-label="Primary">
          <ul>
            <li><a href="/features">Features</a></li>
            <li><a href="/pricing">Pricing</a></li>
            <li><a href="/demo">Demo</a></li>
            <li><a href="/press">Press</a></li>
          </ul>
        </nav>
        <div class="site-header__cta">
          <% if (currentUser) { %>
            <% const dashboardHref = currentUser.role === 'AGENCY' ? '/dashboard/agency' : '/dashboard/talent'; %>
            <a class="button button-secondary" href="<%= dashboardHref %>">Dashboard</a>
          <% } else { %>
            <a class="link-muted" href="/login">Login</a>
            <a class="button button-secondary" href="/signup">Sign up</a>
          <% } %>
          <a class="button button-primary" href="/apply">Start Free PDF</a>
        </div>
      </div>
      <div class="mobile-nav-panel" id="mobileNav" hidden>
        <ul>
          <li><a href="/features">Features</a></li>
          <li><a href="/pricing">Pricing</a></li>
          <li><a href="/demo">Demo</a></li>
          <li><a href="/press">Press</a></li>
          <li><a href="/legal">Legal</a></li>
          <% if (currentUser) { %>
            <li><a href="<%= currentUser.role === 'AGENCY' ? '/dashboard/agency' : '/dashboard/talent' %>">Dashboard</a></li>
          <% } else { %>
            <li><a href="/login">Login</a></li>
            <li><a href="/signup">Sign up</a></li>
          <% } %>
          <li><a class="button button-primary" href="/apply">Start Free PDF</a></li>
        </ul>
      </div>
    </header>
  <% } %>

  <main id="main" class="main <%= isDashboard ? 'dashboard-main' : 'page-main' %>" role="main">
    <%- include('partials/flash', { messages }) %>
    <%- body %>
  </main>

  <% if (!isDashboard) { %>
    <footer class="site-footer" role="contentinfo">
      <div class="container site-footer__inner">
        <p>© <%= new Date().getFullYear() %> ZipSite. Editorial-quality comp cards for modern talent.</p>
        <nav aria-label="Footer">
          <ul>
            <li><a href="/legal">Legal</a></li>
            <li><a href="/pricing">Pricing</a></li>
            <li><a href="/features">Features</a></li>
          </ul>
        </nav>
      </div>
    </footer>
  <% } %>

  <script src="/scripts/wire.js" defer></script>
  <% if (isDashboard) { %>
    <script src="/scripts/dashboard.js" defer></script>
  <% } %>
</body>
</html>
